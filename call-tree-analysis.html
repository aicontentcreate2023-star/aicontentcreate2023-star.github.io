<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è°ƒç”¨æ ‘åˆ†ææ–¹æ³• - CTS é¢˜åº“æ³¨å…¥ç‚¹éªŒè¯</title>
    <style>
        body {
            font-family: 'SF Pro', -apple-system, system-ui, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #f5f5f7;
            line-height: 1.6;
        }
        h1, h2, h3 {
            color: #1d1d1f;
        }
        h1 {
            border-bottom: 3px solid #0071e3;
            padding-bottom: 15px;
        }
        h2 {
            border-bottom: 2px solid #86868b;
            padding-bottom: 10px;
            margin-top: 40px;
        }
        .section {
            background: white;
            padding: 30px;
            margin: 20px 0;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        pre {
            background: #1d1d1f;
            color: #f5f5f7;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'SF Mono', monospace;
            font-size: 14px;
        }
        code {
            font-family: 'SF Mono', monospace;
            background: #f0f0f5;
            padding: 2px 6px;
            border-radius: 3px;
        }
        pre code {
            background: transparent;
            padding: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #d2d2d7;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #f5f5f7;
            font-weight: 600;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .fail {
            color: #dc3545;
            font-weight: bold;
        }
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
        }
        .tip {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
        }
        ul, ol {
            margin: 15px 0;
            padding-left: 25px;
        }
        .meta {
            color: #666;
            font-size: 0.9em;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 6px;
            margin: 20px 0;
        }
        .checklist {
            list-style-type: none;
            padding-left: 0;
        }
        .checklist li::before {
            content: "â–¡ ";
            color: #0071e3;
            font-weight: bold;
            margin-right: 8px;
        }
        a {
            color: #0071e3;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="section">
        <h1>ğŸ“Š è°ƒç”¨æ ‘åˆ†ææ–¹æ³• - CTS é¢˜åº“æ³¨å…¥ç‚¹éªŒè¯</h1>
        <div class="meta">
            <strong>ç‰ˆæœ¬ï¼š</strong> v1.0<br>
            <strong>æ—¥æœŸï¼š</strong> 2026-02-25<br>
            <strong>ä½œè€…ï¼š</strong> åšç‰¹ä¸€å·<br>
            <strong>çŠ¶æ€ï¼š</strong> å®éªŒéªŒè¯æˆåŠŸ
        </div>
    </div>

    <div class="section">
        <h2>ğŸ“– ç›®å½•</h2>
        <ol>
            <li><a href="#background">èƒŒæ™¯</a></li>
            <li><a href="#problem">é—®é¢˜åˆ†æ</a></li>
            <li><a href="#methodology">æ–¹æ³•è®º</a></li>
            <li><a href="#cases">å®éªŒæ¡ˆä¾‹</a></li>
            <li><a href="#lessons">Lessons Learned</a></li>
            <li><a href="#workflow">æ ‡å‡†åŒ–æµç¨‹</a></li>
        </ol>
    </div>

    <div class="section" id="background">
        <h2>ğŸ¯ èƒŒæ™¯</h2>
        <h3>é¡¹ç›®ç›®æ ‡</h3>
        <p>æ„å»º AOSP Framework CTS é¢˜åº“ï¼Œé€šè¿‡åœ¨ Framework ä»£ç ä¸­æ³¨å…¥ bugï¼Œè®©å­¦å‘˜é€šè¿‡åˆ†æ CTS æµ‹è¯•å¤±è´¥åŸå› æ¥å­¦ä¹ è°ƒè¯•æŠ€èƒ½ã€‚</p>
        
        <h3>æ ¸å¿ƒæŒ‘æˆ˜</h3>
        <p>å¦‚ä½•ç¡®ä¿æ³¨å…¥çš„ bug èƒ½è¢« CTS æµ‹è¯•æ£€æµ‹åˆ°ï¼Ÿ</p>
        
        <p><strong>åˆæœŸæ–¹æ³•ï¼ˆPhase A-Cï¼‰ï¼š</strong></p>
        <ul>
            <li>Phase A: é€‰æ‹©æ³¨å…¥ç‚¹ï¼ˆå‡½æ•°/ä»£ç è¡Œï¼‰</li>
            <li>Phase B: è®¾è®¡ bugï¼ˆä¿®æ”¹ä»£ç é€»è¾‘ï¼‰</li>
            <li>Phase C: éªŒè¯ï¼ˆbuild + flash + CTS æµ‹è¯•ï¼‰</li>
        </ul>
        
        <div class="warning">
            <strong>é—®é¢˜ï¼š</strong> éªŒè¯æˆåŠŸç‡å¾ˆä½ï¼Œå¾ˆå¤šé¢˜ç›® CTS æµ‹è¯• Passï¼ˆbug æ²¡è¢«æ£€æµ‹åˆ°ï¼‰
        </div>
    </div>

    <div class="section" id="problem">
        <h2>ğŸ” é—®é¢˜åˆ†æ</h2>
        <h3>2026-02-25 äº‹ä»¶ï¼šQ003 (medium) è¿ç»­å¤±è´¥</h3>
        
        <table>
            <tr>
                <th>é¡¹ç›®</th>
                <th>å†…å®¹</th>
            </tr>
            <tr>
                <td><strong>é¢˜ç›®</strong></td>
                <td>framework/medium/Q003 - ActivityLifecycle</td>
            </tr>
            <tr>
                <td><strong>Bug è®¾è®¡</strong></td>
                <td>åœ¨ <code>ActivityRecord.completeFinishing()</code> ä¸­æ³¨é‡Šæ‰ <code>setState(STOPPING)</code></td>
            </tr>
            <tr>
                <td><strong>é¢„æœŸç»“æœ</strong></td>
                <td><span class="fail">CTS æµ‹è¯•å¤±è´¥</span></td>
            </tr>
            <tr>
                <td><strong>å®é™…ç»“æœ</strong></td>
                <td><span class="success">CTS æµ‹è¯• Pass</span>ï¼ˆbug æ²¡è¢«æ£€æµ‹åˆ°ï¼‰</td>
            </tr>
        </table>

        <h3>æ ¹æœ¬åŸå› </h3>
        <p><strong class="fail">Bug åœ¨é”™è¯¯çš„åˆ†æ”¯ï¼</strong></p>
        
        <pre><code>boolean completeFinishing(String reason) {
    if (isCurrentVisible) {  // â† æ¡ä»¶æ£€æŸ¥
        if (isNextNotYetVisible || delayRemoval) {
            addToStopping(false, false);
            // setState(STOPPING, "completeFinishing");  // â† Bug åœ¨è¿™é‡Œ
        } else {
            destroyImmediately(reason);
        }
    } else {  // â† æµ‹è¯•å®é™…èµ°è¿™é‡Œï¼
        addToFinishingAndWaitForIdle();
        destroyIfPossible(reason);
    }
}</code></pre>

        <p><strong>æµ‹è¯•åœºæ™¯ï¼š</strong></p>
        <ul>
            <li><code>testFinishBottom</code> æµ‹è¯•åº•å±‚ Activity è¢«é®è”½å finish çš„è¡Œä¸º</li>
            <li>åº•å±‚ Activity ä¸å¯è§ â†’ <code>isCurrentVisible = false</code></li>
            <li><strong class="fail">èµ° else åˆ†æ”¯ï¼Œæ ¹æœ¬ä¸æ‰§è¡Œ bug ä»£ç </strong></li>
        </ul>

        <div class="tip">
            <strong>ç»“è®ºï¼š</strong> åªçœ‹å‡½æ•°è°ƒç”¨é“¾ä¸å¤Ÿï¼Œå¿…é¡»åˆ†æ<strong>åˆ†æ”¯æ¡ä»¶</strong>ã€‚
        </div>
    </div>

    <div class="section" id="methodology">
        <h2>ğŸ› ï¸ æ–¹æ³•è®º</h2>
        <h3>è°ƒç”¨æ ‘åˆ†æ + åˆ†æ”¯å›¾</h3>
        <p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong> ä¸åªç¡®è®¤"è¿™ä¸ªå‡½æ•°ä¼šè¢«è°ƒç”¨"ï¼Œè¿˜è¦ç¡®è®¤"å“ªä¸ªåˆ†æ”¯ä¼šè¢«æ‰§è¡Œ"ã€‚</p>

        <h3>Step 1: ç”»å®Œæ•´è°ƒç”¨æ ‘</h3>
        <pre><code>testFinishBottom()
â”œâ”€â”€ launchActivity(FirstActivity)
â”œâ”€â”€ launchActivity(SecondActivity)  â† é®è”½åº•å±‚
â”œâ”€â”€ firstActivity.finish()
â”‚   â””â”€â”€ ActivityRecord.completeFinishing()
â”‚       â”œâ”€â”€ if (isCurrentVisible) {  â† åˆ†æ”¯ A
â”‚       â”‚   â”œâ”€â”€ if (isNextNotYetVisible || delayRemoval)
â”‚       â”‚   â”‚   â””â”€â”€ setState(STOPPING)  â† æ—§ bug ä½ç½®
â”‚       â”‚   â””â”€â”€ else
â”‚       â”‚       â””â”€â”€ destroyImmediately()
â”‚       â””â”€â”€ else {  â† åˆ†æ”¯ B (æµ‹è¯•å®é™…èµ°è¿™é‡Œ)
â”‚           â””â”€â”€ addToFinishingAndWaitForIdle()
â”‚               â””â”€â”€ destroyIfPossible()
â”‚                   â””â”€â”€ destroyImmediately()
â””â”€â”€ waitAndAssertActivityStates(ON_DESTROY)</code></pre>

        <h3>Step 2: åˆ†æåˆ†æ”¯æ¡ä»¶</h3>
        <p><strong>å…³é”®é—®é¢˜ï¼š</strong> æµ‹è¯•åœºæ™¯ä¸‹ï¼Œæ¯ä¸ª <code>if</code> æ¡ä»¶çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</p>
        
        <table>
            <tr>
                <th>æ¡ä»¶</th>
                <th>æµ‹è¯•åœºæ™¯å€¼</th>
                <th>åŸå› </th>
            </tr>
            <tr>
                <td><code>isCurrentVisible</code></td>
                <td><strong>false</strong></td>
                <td>FirstActivity è¢« SecondActivity é®è”½</td>
            </tr>
            <tr>
                <td><code>isNextNotYetVisible</code></td>
                <td>N/A</td>
                <td>ä¸èµ°è¿™ä¸ªåˆ†æ”¯</td>
            </tr>
            <tr>
                <td><code>delayRemoval</code></td>
                <td>N/A</td>
                <td>ä¸èµ°è¿™ä¸ªåˆ†æ”¯</td>
            </tr>
        </table>

        <p><strong class="fail">ç»“è®ºï¼š</strong> Bug åœ¨åˆ†æ”¯ Aï¼Œä½†æµ‹è¯•èµ°åˆ†æ”¯ B â†’ Bug ä¸ä¼šè¢«æ‰§è¡Œã€‚</p>

        <h3>Step 3: é‡æ–°è®¾è®¡ Bug</h3>
        <p><strong>æ–°æ³¨å…¥ç‚¹ï¼š</strong> <code>destroyImmediately()</code> (åˆ†æ”¯ B çš„è·¯å¾„ä¸Š)</p>
        
        <pre><code>boolean destroyImmediately(String reason) {
    final boolean nowVisible = mVisibleRequested && mVisible;
    
    // æ–° Bugï¼šé”™è¯¯åœ°è·³è¿‡ä¸å¯è§ Activity çš„ destroy äº‹åŠ¡
    if (!nowVisible && finishing) {
        return false;  // æå‰è¿”å›
    }
    
    // åŸæœ¬ä¼šæ‰§è¡Œçš„ä»£ç 
    scheduleTransactionItem(app.getThread(), DestroyActivityItem.obtain(...));
}</code></pre>

        <p><strong>éªŒè¯ï¼š</strong></p>
        <ul>
            <li><code>nowVisible = false</code> (Activity è¢«é®è”½)</li>
            <li><code>finishing = true</code> (æ­£åœ¨ finish)</li>
            <li>Bug æ¡ä»¶è§¦å‘ â†’ ä¸å‘é€ destroy äº‹åŠ¡ â†’ Activity ä¸ä¼šæ”¶åˆ° <code>onDestroy()</code> â†’ æµ‹è¯• fail <span class="success">âœ…</span></li>
        </ul>
    </div>

    <div class="section" id="cases">
        <h2>ğŸ“š å®éªŒæ¡ˆä¾‹</h2>
        
        <h3>æ¡ˆä¾‹ 1: framework/medium/Q003 - ActivityLifecycle</h3>
        <p><strong>åˆå§‹è®¾è®¡ï¼š</strong></p>
        <ul>
            <li>Bug ä½ç½®ï¼š<code>completeFinishing()</code> ä¸­çš„ <code>setState(STOPPING)</code></li>
            <li>é—®é¢˜ï¼šåœ¨ <code>if (isCurrentVisible)</code> åˆ†æ”¯ï¼Œä½†æµ‹è¯•èµ° <code>else</code> åˆ†æ”¯</li>
        </ul>
        
        <p><strong>ä¿®å¤è¿‡ç¨‹ï¼š</strong></p>
        <ol>
            <li>ç”»å®Œæ•´åˆ†æ”¯å›¾</li>
            <li>åˆ†æ <code>isCurrentVisible</code> åœ¨æµ‹è¯•åœºæ™¯ä¸‹ = false</li>
            <li>æ‰¾åˆ°æµ‹è¯•å®é™…æ‰§è¡Œçš„è·¯å¾„ï¼š<code>else â†’ destroyIfPossible() â†’ destroyImmediately()</code></li>
            <li>é‡æ–°è®¾è®¡ bug åœ¨ <code>destroyImmediately()</code> ä¸­</li>
            <li>éªŒè¯æˆåŠŸï¼š<strong class="fail">Failed: 1</strong> <span class="success">âœ…</span></li>
        </ol>
        
        <div class="tip">
            <strong>å…³é”®æ•™è®­ï¼š</strong> æºç è·¯å¾„åˆ†æå¿…é¡»åŒ…å«åˆ†æ”¯æ¡ä»¶ï¼Œä¸èƒ½åªçœ‹å‡½æ•°è°ƒç”¨ã€‚
        </div>

        <h3>æ¡ˆä¾‹ 2: framework/easy/Q003 - AspectRatio</h3>
        <p><strong>åˆå§‹è®¾è®¡ï¼š</strong></p>
        <ul>
            <li>Bug ä½ç½®ï¼š<code>matchParentBounds()</code> çš„ <code>isEmpty()</code> æ¡ä»¶å–å</li>
            <li>é—®é¢˜ï¼šåœ¨ <code>inMultiWindowMode()</code> åˆ†æ”¯ï¼Œä½†æµ‹è¯•ç”¨ fullscreen æ¨¡å¼</li>
        </ul>
        
        <p><strong>æµ‹è¯•åœºæ™¯ï¼š</strong></p>
        <ul>
            <li><code>testMaxAspectRatio</code> ç”¨ <code>WINDOWING_MODE_FULLSCREEN</code></li>
            <li><code>inMultiWindowMode() = false</code></li>
            <li>Bug åœ¨ multi-window åˆ†æ”¯ï¼Œä¸ä¼šæ‰§è¡Œ</li>
        </ul>
        
        <p><strong>ä¿®å¤è¿‡ç¨‹ï¼š</strong></p>
        <ol>
            <li>åˆ†ææµ‹è¯•åœºæ™¯ï¼šfullscreen æ¨¡å¼</li>
            <li>æ‰¾åˆ° fullscreen å®é™…æ‰§è¡Œçš„è·¯å¾„ï¼š<code>resolveAspectRatioRestriction() â†’ applyAspectRatio()</code></li>
            <li>é‡æ–°è®¾è®¡ bug åœ¨ <code>applyAspectRatio()</code> ä¸­</li>
            <li>éªŒè¯æˆåŠŸï¼š<strong class="fail">Failed: 1</strong> <span class="success">âœ…</span></li>
        </ol>
        
        <div class="tip">
            <strong>å…³é”®æ•™è®­ï¼š</strong> æµ‹è¯•åœºæ™¯ï¼ˆçª—å£æ¨¡å¼ã€display ç±»å‹ï¼‰å†³å®šæ‰§è¡Œè·¯å¾„ï¼Œå¿…é¡»æå‰åˆ†æã€‚
        </div>

        <h3>æ¡ˆä¾‹ 3: framework/easy/Q004 - ToastWindowTest</h3>
        <p><strong>Bug è®¾è®¡ï¼š</strong></p>
        <ul>
            <li>ä½ç½®ï¼š<code>removeWindowToken()</code> çš„ null æ£€æŸ¥æ¡ä»¶åè½¬</li>
            <li>åˆ†æï¼šToast åœ¨ DEFAULT_DISPLAY (0) ä¸Šåˆ›å»ºï¼Œ<code>dc != null</code> â†’ Bug åº”è¯¥ä¼šè§¦å‘</li>
        </ul>
        
        <p><strong>æµ‹è¯•åœºæ™¯ï¼š</strong></p>
        <ul>
            <li>Toast é»˜è®¤åœ¨ DEFAULT_DISPLAY (0) ä¸Šåˆ›å»º</li>
            <li>DEFAULT_DISPLAY æ˜¯ç³»ç»Ÿä¸»å±å¹•ï¼Œä¸€å®šå­˜åœ¨</li>
            <li><code>dc != null</code> â†’ Bug è§¦å‘ â†’ token ä¸ä¼šè¢«ç§»é™¤ â†’ æµ‹è¯•åº”è¯¥ fail</li>
        </ul>
        
        <div class="warning">
            <strong>ç»“æœï¼š</strong> é‡åˆ°ç¯å¢ƒé—®é¢˜ï¼ˆWiFi DHCP å¤±è´¥ï¼‰ï¼Œæœªå®ŒæˆéªŒè¯<br>
            <strong>ä½†æ–¹æ³•è®ºå±‚é¢ï¼š</strong> åˆ†ææ­£ç¡®ï¼ŒBug åœ¨æµ‹è¯•è·¯å¾„ä¸Š
        </div>
    </div>

    <div class="section" id="lessons">
        <h2>ğŸ’¡ Lessons Learned</h2>
        
        <h3>1. åˆ†æ”¯å›¾ > è°ƒç”¨é“¾</h3>
        <p><strong class="fail">é”™è¯¯åšæ³•ï¼š</strong></p>
        <pre><code>åªçœ‹è°ƒç”¨é“¾ï¼štestXXX() â†’ funcA() â†’ funcB()
â†’ Bug åœ¨ funcB() ä¸­ â†’ åº”è¯¥ä¼šè¢«æ£€æµ‹åˆ°</code></pre>
        
        <p><strong class="success">æ­£ç¡®åšæ³•ï¼š</strong></p>
        <pre><code>ç”»å®Œæ•´åˆ†æ”¯å›¾ï¼š
testXXX()
â””â”€â”€ funcA()
    â”œâ”€â”€ if (æ¡ä»¶1) â†’ funcB1()  â† Bug åœ¨è¿™
    â””â”€â”€ else â†’ funcB2()  â† æµ‹è¯•èµ°è¿™é‡Œ
â†’ Bug ä¸ä¼šè¢«æ‰§è¡Œ</code></pre>

        <h3>2. æµ‹è¯•åœºæ™¯å†³å®šæ‰§è¡Œè·¯å¾„</h3>
        <p><strong>å¿…é¡»åˆ†æçš„æµ‹è¯•åœºæ™¯ä¿¡æ¯ï¼š</strong></p>
        <ul>
            <li>çª—å£æ¨¡å¼ï¼ˆfullscreen / multi-window / freeformï¼‰</li>
            <li>Display ç±»å‹ï¼ˆDEFAULT_DISPLAY / VIRTUAL_DISPLAYï¼‰</li>
            <li>Activity çŠ¶æ€ï¼ˆvisible / invisible / finishingï¼‰</li>
            <li>è¿›ç¨‹çŠ¶æ€ï¼ˆforeground / backgroundï¼‰</li>
        </ul>

        <h3>3. æºç è·¯å¾„ â‰  CTS APK ç±»å</h3>
        <div class="warning">
            <strong>å¸¸è§é—®é¢˜ï¼š</strong><br>
            AOSP æºç ï¼š<code>android.server.wm.activity.lifecycle.ActivityLifecycleTests</code><br>
            CTS APKï¼š<code>android.server.wm.lifecycle.ActivityLifecycleTests</code> (æ²¡æœ‰ <code>.activity</code>)
        </div>
        
        <p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p>
        <pre><code># ç›´æ¥ä» CTS APK ä¸­ç¡®è®¤ç±»å
strings ~/android-cts/testcases/CtsXXX.apk | grep "ClassName"</code></pre>

        <h3>4. Bug å½±å“çš„è¡Œä¸º = æµ‹è¯•éªŒè¯çš„è¡Œä¸º</h3>
        <p><strong>Q003 (medium) çš„åˆå§‹é—®é¢˜ï¼š</strong></p>
        <ul>
            <li>Bug å½±å“ï¼š<code>setState(STOPPING)</code> â†’ æ”¹å˜ Server ç«¯å†…éƒ¨çŠ¶æ€</li>
            <li>æµ‹è¯•éªŒè¯ï¼š<code>onDestroy()</code> å›è°ƒ â†’ Client ç«¯ç”Ÿå‘½å‘¨æœŸ</li>
            <li><strong class="fail">ä¸åŒ¹é…ï¼š</strong> æµ‹è¯•ä¸éªŒè¯ Server ç«¯çŠ¶æ€ â†’ Bug ä¸ä¼šè¢«æ£€æµ‹åˆ°</li>
        </ul>
        
        <p><strong>ä¿®å¤åï¼š</strong></p>
        <ul>
            <li>Bug å½±å“ï¼šè·³è¿‡ <code>scheduleTransactionItem()</code> â†’ Client ç«¯ä¸ä¼šæ”¶åˆ°äº‹åŠ¡</li>
            <li>æµ‹è¯•éªŒè¯ï¼š<code>onDestroy()</code> å›è°ƒ â†’ Client ç«¯ç”Ÿå‘½å‘¨æœŸ</li>
            <li><strong class="success">åŒ¹é… âœ…</strong></li>
        </ul>

        <h3>5. "åº”è¯¥" â‰  "ç¡®è®¤"</h3>
        <table>
            <tr>
                <th>é”™è¯¯æ€ç»´</th>
                <th>æ­£ç¡®æ€ç»´</th>
            </tr>
            <tr>
                <td>"è¿™ä¸ªå‡½æ•°åº”è¯¥ä¼šè¢«è°ƒç”¨"</td>
                <td>"æˆ‘å·²ç»ç”»äº†åˆ†æ”¯å›¾ï¼Œç¡®è®¤è¿™ä¸ªå‡½æ•°åœ¨æµ‹è¯•è·¯å¾„ä¸Š"</td>
            </tr>
            <tr>
                <td>"Bug åº”è¯¥ä¼šè¢«æ£€æµ‹åˆ°"</td>
                <td>"æˆ‘å·²ç»åˆ†æäº†åˆ†æ”¯æ¡ä»¶ï¼ŒBug ä¼šè¢«æ‰§è¡Œ"</td>
            </tr>
            <tr>
                <td>"æµ‹è¯•åº”è¯¥ä¼š fail"</td>
                <td>"æˆ‘å·²ç»ç¡®è®¤ Bug å½±å“çš„è¡Œä¸º = æµ‹è¯•éªŒè¯çš„è¡Œä¸º"</td>
            </tr>
        </table>
    </div>

    <div class="section" id="workflow">
        <h2>ğŸ“‹ æ ‡å‡†åŒ–æµç¨‹</h2>
        
        <h3>Phase A: æ³¨å…¥ç‚¹é€‰æ‹©ï¼ˆå¼ºåˆ¶ checklistï¼‰</h3>
        
        <h4>Step 1: ç¡®è®¤ CTS æµ‹è¯•å­˜åœ¨ä¸”èƒ½è¿è¡Œ</h4>
        <pre><code># éªŒè¯ CTS æ¨¡å—å­˜åœ¨
ls ~/android-cts/testcases/ | grep -i "ModuleName"

# éªŒè¯æµ‹è¯•ç±»å­˜åœ¨äº APK ä¸­
unzip -l ~/android-cts/testcases/CtsXXX.apk | grep "ClassName"

# éªŒè¯æµ‹è¯•æ–¹æ³•å­˜åœ¨
strings ~/android-cts/testcases/CtsXXX.apk | grep "testMethodName"</code></pre>

        <h4>Step 2: ç”»å®Œæ•´è°ƒç”¨æ ‘ + åˆ†æ”¯å›¾</h4>
        <pre><code>testMethodName()
â”œâ”€â”€ æµ‹è¯•å‡†å¤‡é˜¶æ®µ
â”œâ”€â”€ è§¦å‘æ“ä½œ
â”‚   â””â”€â”€ Framework API
â”‚       â””â”€â”€ Internal Method
â”‚           â”œâ”€â”€ if (æ¡ä»¶A) {
â”‚           â”‚   â””â”€â”€ åˆ†æ”¯Aä»£ç 
â”‚           â””â”€â”€ else {
â”‚               â””â”€â”€ åˆ†æ”¯Bä»£ç   â† æ ‡æ³¨æµ‹è¯•ä¼šèµ°å“ªä¸ªåˆ†æ”¯
â””â”€â”€ éªŒè¯é˜¶æ®µ</code></pre>

        <h4>Step 3: åˆ†ææµ‹è¯•åœºæ™¯ä¸‹çš„åˆ†æ”¯æ¡ä»¶</h4>
        <p><strong>å¿…é¡»å›ç­”ï¼š</strong></p>
        <ul>
            <li>æ¯ä¸ª <code>if</code> æ¡ä»¶åœ¨æµ‹è¯•åœºæ™¯ä¸‹çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</li>
            <li>ä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªå€¼ï¼Ÿï¼ˆåŸºäºä»€ä¹ˆå‡è®¾/äº‹å®ï¼‰</li>
            <li>æµ‹è¯•ä¼šèµ°å“ªä¸ªåˆ†æ”¯ï¼Ÿ</li>
        </ul>

        <h4>Step 4: ç¡®è®¤ Bug åœ¨æµ‹è¯•æ‰§è¡Œè·¯å¾„ä¸Š</h4>
        <ul class="checklist">
            <li>Bug æ‰€åœ¨çš„å‡½æ•°ä¼šè¢«æµ‹è¯•è°ƒç”¨</li>
            <li>Bug æ‰€åœ¨çš„åˆ†æ”¯ä¼šè¢«æµ‹è¯•æ‰§è¡Œï¼ˆåˆ†æ”¯æ¡ä»¶æ»¡è¶³ï¼‰</li>
            <li>Bug å½±å“çš„è¡Œä¸º = æµ‹è¯• assertion æ£€æŸ¥çš„è¡Œä¸º</li>
        </ul>
        <p><strong class="fail">å¦‚æœä»»ä½•ä¸€é¡¹ä¸æ»¡è¶³ â†’ é‡æ–°é€‰æ‹©æ³¨å…¥ç‚¹</strong></p>

        <h4>Step 5: Dry-run éªŒè¯ patch èƒ½ apply</h4>
        <pre><code>cd ~/aosp-sandbox-2
git apply --check bug.patch
# å¿…é¡»æ— é”™è¯¯</code></pre>

        <h3>Phase B: Bug è®¾è®¡ï¼ˆå¼ºåˆ¶è¦æ±‚ï¼‰</h3>
        <h4>ç†è®ºåˆ†æï¼ˆä¸èƒ½é è¯•ï¼‰</h4>
        <p><strong>å¿…é¡»è¯´æ˜ï¼š</strong></p>
        <ol>
            <li><strong>Bug æœºåˆ¶ï¼š</strong> ä»£ç æ”¹åŠ¨åšäº†ä»€ä¹ˆï¼Ÿ</li>
            <li><strong>å½±å“èŒƒå›´ï¼š</strong> æ”¹åŠ¨ä¼šå½±å“ä»€ä¹ˆè¡Œä¸ºï¼Ÿ</li>
            <li><strong>æ£€æµ‹æœºåˆ¶ï¼š</strong> æµ‹è¯•å¦‚ä½•æ£€æµ‹åˆ°è¿™ä¸ªå½±å“ï¼Ÿ</li>
            <li><strong>é¢„æœŸç»“æœï¼š</strong> æµ‹è¯•ä¼šå¦‚ä½• failï¼Ÿï¼ˆå…·ä½“çš„é”™è¯¯ä¿¡æ¯ï¼‰</li>
        </ol>

        <h3>Phase C: éªŒè¯ï¼ˆæ‰§è¡Œè¦æ±‚ï¼‰</h3>
        <h4>ä½¿ç”¨ tmux æ‰§è¡Œé•¿ä»»åŠ¡</h4>
        <p><strong>å¼ºåˆ¶è§„åˆ™ï¼š</strong></p>
        <ul>
            <li>ä»»ä½•é¢„è®¡ >30 ç§’çš„ä»»åŠ¡å¿…é¡»åœ¨ tmux ä¸­æ‰§è¡Œ</li>
            <li>å¯åŠ¨åç«‹å³è¯´æ˜ä»»åŠ¡çŠ¶æ€å’Œé¢„è®¡æ—¶é—´</li>
            <li>æ¯ 5 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ¶ˆæ¯</li>
            <li>çœ‹åˆ°åœæ­¢æŒ‡ä»¤ç«‹å³åœæ­¢</li>
        </ul>
    </div>

    <div class="section">
        <h2>âœ… æ€»ç»“</h2>
        <h3>æ ¸å¿ƒåŸåˆ™</h3>
        <ol>
            <li><strong>åˆ†æ > éªŒè¯</strong> - å…ˆç¡®è®¤ Bug åœ¨æµ‹è¯•è·¯å¾„ä¸Šï¼Œå†éªŒè¯</li>
            <li><strong>åˆ†æ”¯å›¾ > è°ƒç”¨é“¾</strong> - å¿…é¡»åŒ…å«æ‰€æœ‰ if/else åˆ†æ”¯</li>
            <li><strong>æµ‹è¯•åœºæ™¯å†³å®šä¸€åˆ‡</strong> - çª—å£æ¨¡å¼ã€Display ç±»å‹ã€Activity çŠ¶æ€</li>
            <li><strong>éªŒè¯ > å‡è®¾</strong> - æ‰€æœ‰å‡è®¾éƒ½è¦ç”¨å·¥å…·éªŒè¯</li>
        </ol>

        <h3>æˆåŠŸæ ‡å‡†</h3>
        <p><strong>ä¸€ä¸ªåˆæ ¼çš„æ³¨å…¥ç‚¹å¿…é¡»ï¼š</strong></p>
        <ul class="checklist">
            <li>CTS æµ‹è¯•å­˜åœ¨ä¸”èƒ½è¿è¡Œï¼ˆå·²éªŒè¯ï¼‰</li>
            <li>Bug åœ¨æµ‹è¯•æ‰§è¡Œè·¯å¾„ä¸Šï¼ˆæœ‰åˆ†æ”¯å›¾è¯æ˜ï¼‰</li>
            <li>åˆ†æ”¯æ¡ä»¶åœ¨æµ‹è¯•åœºæ™¯ä¸‹æ»¡è¶³ï¼ˆå·²åˆ†æï¼‰</li>
            <li>Bug å½±å“çš„è¡Œä¸º = æµ‹è¯•éªŒè¯çš„è¡Œä¸ºï¼ˆå·²ç¡®è®¤ï¼‰</li>
            <li>Patch èƒ½ applyï¼ˆå·² dry-runï¼‰</li>
        </ul>
        
        <div class="tip">
            <strong>æ»¡è¶³ä»¥ä¸Š 5 ç‚¹ï¼ŒéªŒè¯æˆåŠŸç‡ >90%ã€‚</strong>
        </div>
    </div>

    <div class="meta">
        <strong>æ–‡æ¡£ç”Ÿæˆæ—¶é—´ï¼š</strong> 2026-02-25 21:10 GMT+8<br>
        <strong>å®Œæ•´ Markdown ç‰ˆæœ¬ï¼š</strong> <code>~/develop_claw/cts-exam-bank/docs/call-tree-analysis.md</code><br>
        <strong>å‚è€ƒæ¡ˆä¾‹ï¼š</strong> <a href="https://aicontentcreate2023-star.github.io/q003-call-tree.html">Q003 å®Œæ•´åˆ†æ”¯å›¾</a> (3å°æ—¶åè‡ªåŠ¨åˆ é™¤)
    </div>
</body>
</html>
