<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>isMinimal æ©Ÿåˆ¶è©³è§£</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            line-height: 1.8;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #9b59b6;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 40px;
            border-left: 4px solid #9b59b6;
            padding-left: 15px;
        }
        h3 {
            color: #555;
            margin-top: 25px;
        }
        .version {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-bottom: 30px;
        }
        .diagram {
            background: #ecf0f1;
            border-left: 4px solid #e74c3c;
            padding: 20px;
            margin: 25px 0;
            border-radius: 5px;
        }
        .diagram strong {
            color: #e74c3c;
        }
        code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: "SF Mono", Monaco, monospace;
            font-size: 0.9em;
        }
        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            line-height: 1.5;
        }
        .highlight {
            background: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
        }
        .warning {
            background: #ffe5e5;
            padding: 15px;
            border-left: 4px solid #e74c3c;
            margin: 20px 0;
        }
        .success {
            background: #e8f5e9;
            padding: 15px;
            border-left: 4px solid #4caf50;
            margin: 20px 0;
        }
        ul, ol {
            margin-left: 20px;
        }
        li {
            margin: 8px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #9b59b6;
            color: white;
        }
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .comparison > div {
            padding: 15px;
            border-radius: 5px;
        }
        .comparison .full {
            background: #e3f2fd;
            border: 2px solid #2196f3;
        }
        .comparison .minimal {
            background: #fff3e0;
            border: 2px solid #ff9800;
        }
    </style>
</head>
<body>
    <h1>âš™ï¸ isMinimal æ©Ÿåˆ¶è©³è§£</h1>
    <div class="version">
        ğŸ“„ ç‰ˆæœ¬ï¼šv1.0<br>
        ğŸ•’ æœ€å¾Œæ›´æ–°ï¼š2026-02-09 17:40 GMT+8
    </div>

    <h2>ä¸€ã€ä»€éº¼æ˜¯ isMinimalï¼Ÿ</h2>
    <p>
        <code>isMinimal</code> æ˜¯ Clawdbot çš„<strong>System Prompt ç²¾ç°¡æ¨¡å¼</strong>ï¼Œç”¨ä¾†æ§åˆ¶ï¼š
    </p>
    <ul>
        <li>ğŸ§© å“ªäº› System Prompt å€å¡Šæœƒè¢«è¼‰å…¥</li>
        <li>ğŸ’° Token æ¶ˆè€—é‡ï¼ˆå½±éŸ¿æˆæœ¬ï¼‰</li>
        <li>âš¡ å›æ‡‰é€Ÿåº¦</li>
    </ul>

    <div class="warning">
        <strong>âš ï¸ é—œéµå½±éŸ¿ï¼š</strong><br>
        ç•¶ <code>isMinimal = true</code> æ™‚ï¼Œ<strong>Memory Recall å€å¡Šè¢«è·³é</strong>ï¼Œ
        å°è‡´ Sub-agent ç„¡æ³•ä½¿ç”¨ <code>memory_search</code> å’Œ <code>memory_get</code>ã€‚
    </div>

    <h2>äºŒã€promptMode ä¸‰ç¨®æ¨¡å¼</h2>
    <table>
        <tr>
            <th>æ¨¡å¼</th>
            <th>isMinimal</th>
            <th>é©ç”¨å ´æ™¯</th>
            <th>Token æ¶ˆè€—</th>
        </tr>
        <tr>
            <td><strong>full</strong></td>
            <td>false</td>
            <td>ä¸» sessionï¼ˆèˆ‡ç”¨æˆ¶ç›´æ¥å°è©±ï¼‰</td>
            <td>é«˜ï¼ˆ~10K tokensï¼‰</td>
        </tr>
        <tr>
            <td><strong>minimal</strong></td>
            <td>true</td>
            <td>Sub-agentï¼ˆèƒŒæ™¯ä»»å‹™ï¼‰</td>
            <td>ä½ï¼ˆ~3K tokensï¼‰</td>
        </tr>
        <tr>
            <td><strong>none</strong></td>
            <td>true</td>
            <td>æ¥µç°¡æ¨¡å¼ï¼ˆæ¸¬è©¦ç”¨ï¼‰</td>
            <td>æ¥µä½ï¼ˆ~1K tokensï¼‰</td>
        </tr>
    </table>

    <h2>ä¸‰ã€isMinimal å¦‚ä½•åˆ¤å®šï¼Ÿ</h2>
    <h3>3.1 è‡ªå‹•åˆ¤å®šï¼ˆSub-agentï¼‰</h3>
    <p>æºç¢¼é‚è¼¯ï¼ˆ<code>src/context/system-prompt.ts</code>ï¼‰ï¼š</p>
    <pre>const isMinimal = 
  opts.promptMode === 'minimal' || 
  opts.promptMode === 'none' || 
  (opts.sessionKey && (
    opts.sessionKey.startsWith('sub-') || 
    opts.sessionKey.startsWith('spawn-')
  ));</pre>

    <div class="success">
        <strong>âœ… è‡ªå‹•è§¸ç™¼æ¢ä»¶ï¼š</strong><br>
        ç•¶ sessionKey ä»¥ <code>sub-</code> æˆ– <code>spawn-</code> é–‹é ­æ™‚ï¼Œè‡ªå‹•è¨­ç‚º minimal æ¨¡å¼ã€‚
    </div>

    <h3>3.2 æ‰‹å‹•è¦†è“‹</h3>
    <pre>sessions_spawn({
  task: "...",
  promptMode: "full"  // â† å¼·åˆ¶ä½¿ç”¨ full æ¨¡å¼ï¼ˆç½•è¦‹ï¼‰
})</pre>

    <h2>å››ã€è¢«å½±éŸ¿çš„ 11 å€‹ System Prompt å€å¡Š</h2>
    <div class="diagram">
        <strong>ğŸ¨ [ç”Ÿåœ– Prompt]:</strong><br>
        A comparison diagram showing two columns labeled "FULL MODE" and "MINIMAL MODE". The FULL side has 11 colored blocks stacked vertically (including "Memory Recall", "Skills", "Tool Call Style", etc.), while the MINIMAL side has only 3-4 blocks. Use contrasting colors (blue vs orange). Clean, modern infographic style.
    </div>

    <table>
        <tr>
            <th>#</th>
            <th>å€å¡Šåç¨±</th>
            <th>FULL</th>
            <th>MINIMAL</th>
        </tr>
        <tr>
            <td>1</td>
            <td>Tooling</td>
            <td>âœ…</td>
            <td>âœ…</td>
        </tr>
        <tr>
            <td>2</td>
            <td><strong>Skills</strong></td>
            <td>âœ…</td>
            <td>âŒ</td>
        </tr>
        <tr>
            <td>3</td>
            <td><strong>Tool Call Style</strong></td>
            <td>âœ…</td>
            <td>âŒ</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Clawdbot CLI</td>
            <td>âœ…</td>
            <td>âŒ</td>
        </tr>
        <tr>
            <td>5</td>
            <td><strong>Memory Recall</strong></td>
            <td>âœ…</td>
            <td>âŒ âš ï¸</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Silent Replies</td>
            <td>âœ…</td>
            <td>âœ…</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Heartbeats</td>
            <td>âœ…</td>
            <td>âŒ</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Runtime</td>
            <td>âœ…</td>
            <td>âœ…</td>
        </tr>
        <tr>
            <td>9</td>
            <td>Project Context</td>
            <td>âœ…</td>
            <td>âŒ</td>
        </tr>
        <tr>
            <td>10</td>
            <td>SOUL.md</td>
            <td>âœ…</td>
            <td>âŒ</td>
        </tr>
        <tr>
            <td>11</td>
            <td>USER.md</td>
            <td>âœ…</td>
            <td>âŒ</td>
        </tr>
    </table>

    <div class="warning">
        <strong>âš ï¸ ç‚ºä»€éº¼è·³é Memory Recallï¼Ÿ</strong><br>
        1. <strong>æ€§èƒ½è€ƒé‡</strong> - Sub-agent é€šå¸¸åŸ·è¡ŒçŸ­æœŸä»»å‹™ï¼Œä¸éœ€è¦é•·æœŸè¨˜æ†¶<br>
        2. <strong>æˆæœ¬æ§åˆ¶</strong> - æ¸›å°‘ embedding API èª¿ç”¨<br>
        3. <strong>é¿å…æ··æ·†</strong> - Sub-agent çš„è¨˜æ†¶æ‡‰è©²ç¨ç«‹æ–¼ä¸» session
    </div>

    <h2>äº”ã€Token ç¯€çœæ•ˆæœ</h2>
    <div class="comparison">
        <div class="full">
            <h3>FULL æ¨¡å¼</h3>
            <p><strong>System Prompt:</strong> ~10,000 tokens</p>
            <ul>
                <li>âœ… å®Œæ•´ Skills åˆ—è¡¨</li>
                <li>âœ… AGENTS.md æŒ‡å—</li>
                <li>âœ… SOUL.md å€‹æ€§</li>
                <li>âœ… Memory Recall</li>
            </ul>
        </div>
        <div class="minimal">
            <h3>MINIMAL æ¨¡å¼</h3>
            <p><strong>System Prompt:</strong> ~3,000 tokens</p>
            <ul>
                <li>âœ… åŸºæœ¬å·¥å…·åˆ—è¡¨</li>
                <li>âŒ è·³é Skills</li>
                <li>âŒ è·³é SOUL</li>
                <li>âŒ è·³é Memory</li>
            </ul>
        </div>
    </div>

    <div class="highlight">
        <strong>ğŸ’° ç¯€çœè¨ˆç®—ï¼š</strong><br>
        æ¯å€‹ Sub-agent è«‹æ±‚ç¯€çœ ~7K tokens input<br>
        Claude Sonnet 4.5 å®šåƒ¹ï¼š$3/M tokens input<br>
        â†’ æ¯æ¬¡ Sub-agent ç¯€çœ ~$0.021
    </div>

    <h2>å…­ã€åŠŸèƒ½å·®ç•°å°æ¯”</h2>
    <h3>6.1 ä¸» Sessionï¼ˆFULL æ¨¡å¼ï¼‰</h3>
    <pre><strong>å¯ç”¨åŠŸèƒ½ï¼š</strong>
âœ… memory_search / memory_get
âœ… æ‰€æœ‰ Skillsï¼ˆapple-notes, imsg, etc.ï¼‰
âœ… AGENTS.md è¡Œç‚ºæŒ‡å—
âœ… SOUL.md å€‹æ€§è¨­å®š
âœ… Heartbeat æ©Ÿåˆ¶
âœ… å®Œæ•´å·¥å…·èªªæ˜</pre>

    <h3>6.2 Sub-agentï¼ˆMINIMAL æ¨¡å¼ï¼‰</h3>
    <pre><strong>å¯ç”¨åŠŸèƒ½ï¼š</strong>
âŒ memory_search / memory_get  â† ç„¡æ³•ä½¿ç”¨ï¼
âŒ Skillsï¼ˆéœ€è¦ä¸» session å‘¼å«ï¼‰
âœ… exec, read, write, web_fetch ç­‰åŸºç¤å·¥å…·
âœ… åŸºæœ¬ runtime ä¿¡æ¯</pre>

    <h2>ä¸ƒã€å¯¦éš›æ¡ˆä¾‹</h2>
    <h3>âŒ éŒ¯èª¤æ¡ˆä¾‹ï¼šSub-agent å˜—è©¦ä½¿ç”¨ Memory Recall</h3>
    <pre><strong>ä¸» Sessionï¼š</strong>
sessions_spawn({
  task: "æŸ¥æ‰¾è¨˜äº‹æœ¬ç¤¾åœ˜æœ€æ–°è²¼æ–‡"
})

<strong>Sub-agentï¼ˆè‡ªå‹• minimal æ¨¡å¼ï¼‰ï¼š</strong>
â†’ å˜—è©¦åŸ·è¡Œ memory_search(...)
â†’ âŒ å¤±æ•—ï¼šå·¥å…·ä¸å­˜åœ¨ï¼ˆå› ç‚º Memory Recall å€å¡Šè¢«è·³éï¼‰</pre>

    <h3>âœ… æ­£ç¢ºæ¡ˆä¾‹ï¼šä¸» Session å…ˆæŸ¥è¨˜æ†¶ï¼Œå†æ´¾ Sub-agent</h3>
    <pre><strong>ä¸» Sessionï¼š</strong>
1. memory_search("è¨˜äº‹æœ¬ç¤¾åœ˜æœ€æ–°è²¼æ–‡")
2. memory_get(path, from, lines)
3. å–å¾—æ–‡ä»¶è·¯å¾‘ï¼šè¨˜äº‹æœ¬-ç¤¾åœ˜/index.md
4. sessions_spawn({
     task: "è®€å– è¨˜äº‹æœ¬-ç¤¾åœ˜/index.md ä¸¦æ‘˜è¦"
   })

<strong>Sub-agentï¼š</strong>
â†’ read("è¨˜äº‹æœ¬-ç¤¾åœ˜/index.md")  â† âœ… æˆåŠŸ</pre>

    <h2>å…«ã€å¦‚ä½•æª¢æŸ¥ç•¶å‰æ¨¡å¼ï¼Ÿ</h2>
    <h3>æ–¹æ³• 1ï¼šæª¢æŸ¥ sessionKey</h3>
    <pre>echo $SESSION_KEY

# ä¸» session: main
# Sub-agent: sub-abc123 æˆ– spawn-xyz456</pre>

    <h3>æ–¹æ³• 2ï¼šæª¢æŸ¥ System Prompt</h3>
    <pre>sessions_history(sessionKey, limit: 1)

# å¦‚æœçœ‹åˆ° "Memory Recall" å€å¡Š â†’ FULL æ¨¡å¼
# å¦‚æœæ²’æœ‰ â†’ MINIMAL æ¨¡å¼</pre>

    <h2>ä¹ã€æœªä¾†å„ªåŒ–æ–¹å‘</h2>
    <div class="highlight">
        <strong>ğŸ’¡ æ½›åœ¨æ”¹é€²ï¼ˆå¾…è¨è«–ï¼‰ï¼š</strong><br>
        1. <strong>å…è¨± Sub-agent ä½¿ç”¨ Memory Recallï¼Ÿ</strong><br>
           â†’ éœ€è¦æ¬Šè¡¡æ€§èƒ½ vs åŠŸèƒ½<br><br>
        2. <strong>æ–°å¢ "semi-minimal" æ¨¡å¼ï¼Ÿ</strong><br>
           â†’ ä¿ç•™ Memory Recallï¼Œä½†è·³é SOUL/Skills<br><br>
        3. <strong>å‹•æ…‹è¼‰å…¥æ©Ÿåˆ¶ï¼Ÿ</strong><br>
           â†’ Sub-agent éœ€è¦æ™‚æ‰è¼‰å…¥ Memory Recall
    </div>

    <h2>åã€ç¸½çµ</h2>
    <ul>
        <li>âœ… <code>isMinimal</code> é€šé <code>promptMode</code> æ§åˆ¶</li>
        <li>âœ… Sub-agent è‡ªå‹•è§¸ç™¼ minimal æ¨¡å¼ï¼ˆsessionKey åˆ¤å®šï¼‰</li>
        <li>âœ… Minimal æ¨¡å¼è·³é 11 å€‹å€å¡Šä¸­çš„ 8 å€‹</li>
        <li>âš ï¸ <strong>Memory Recall åœ¨ minimal æ¨¡å¼ä¸‹ä¸å¯ç”¨</strong></li>
        <li>ğŸ’° æ¯å€‹ Sub-agent ç¯€çœ ~7K tokensï¼ˆ~$0.021ï¼‰</li>
    </ul>

    <hr style="margin: 40px 0; border: none; border-top: 2px solid #ecf0f1;">
    <p style="text-align: center; color: #7f8c8d; font-size: 0.9em;">
        ğŸ“š Memory Recall ç³»åˆ—æ–‡æª” 2/4<br>
        ä¸Šä¸€ç¯‡ï¼š<a href="memoryRecall_overview.html">Memory Recall ç³»çµ±æ¦‚è¦½</a><br>
        ä¸‹ä¸€ç¯‡ï¼š<a href="memoryRecall_sessions.html">Sessions æœç´¢æ©Ÿåˆ¶</a>
    </p>
</body>
</html>
